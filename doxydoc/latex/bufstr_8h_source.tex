\hypertarget{bufstr_8h_source}{}\doxysection{bufstr.\+h}
\label{bufstr_8h_source}\index{/mnt/c/projects/doxygen/src/bufstr.h@{/mnt/c/projects/doxygen/src/bufstr.h}}
\mbox{\hyperlink{bufstr_8h}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{1 \textcolor{comment}{/******************************************************************************}}
\DoxyCodeLine{2 \textcolor{comment}{ *}}
\DoxyCodeLine{3 \textcolor{comment}{ *}}
\DoxyCodeLine{4 \textcolor{comment}{ *}}
\DoxyCodeLine{5 \textcolor{comment}{ *}}
\DoxyCodeLine{6 \textcolor{comment}{ * Copyright (C) 1997-\/2015 by Dimitri van Heesch.}}
\DoxyCodeLine{7 \textcolor{comment}{ *}}
\DoxyCodeLine{8 \textcolor{comment}{ * Permission to use, copy, modify, and distribute this software and its}}
\DoxyCodeLine{9 \textcolor{comment}{ * documentation under the terms of the GNU General Public License is hereby}}
\DoxyCodeLine{10 \textcolor{comment}{ * granted. No representations are made about the suitability of this software}}
\DoxyCodeLine{11 \textcolor{comment}{ * for any purpose. It is provided "{}as is"{} without express or implied warranty.}}
\DoxyCodeLine{12 \textcolor{comment}{ * See the GNU General Public License for more details.}}
\DoxyCodeLine{13 \textcolor{comment}{ *}}
\DoxyCodeLine{14 \textcolor{comment}{ * Documents produced by Doxygen are derivative works derived from the}}
\DoxyCodeLine{15 \textcolor{comment}{ * input used in their production; they are not affected by this license.}}
\DoxyCodeLine{16 \textcolor{comment}{ *}}
\DoxyCodeLine{17 \textcolor{comment}{ */}}
\DoxyCodeLine{18 \textcolor{preprocessor}{\#ifndef BUFSTR\_H}}
\DoxyCodeLine{19 \textcolor{preprocessor}{\#define BUFSTR\_H}}
\DoxyCodeLine{20 }
\DoxyCodeLine{21 \textcolor{preprocessor}{\#include <cstdlib>}}
\DoxyCodeLine{22 \textcolor{preprocessor}{\#include "{}\mbox{\hyperlink{qcstring_8h}{qcstring.h}}"{}}}
\DoxyCodeLine{23 }
\DoxyCodeLine{29 \textcolor{keyword}{class }\mbox{\hyperlink{classBufStr}{BufStr}}}
\DoxyCodeLine{30 \{}
\DoxyCodeLine{31   \textcolor{keyword}{public}:}
\DoxyCodeLine{32     \mbox{\hyperlink{classBufStr_ab660fc0bb2bacb390a9bf17964fe081a}{BufStr}}(\textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classBufStr_a05a5b09aa190249aaa59b5ddcf0bddc6}{size}})}
\DoxyCodeLine{33       : m\_size(\mbox{\hyperlink{classBufStr_a05a5b09aa190249aaa59b5ddcf0bddc6}{size}}), m\_writeOffset(0), m\_spareRoom(10240), m\_buf(0)}
\DoxyCodeLine{34     \{}
\DoxyCodeLine{35       m\_buf = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char} *\textcolor{keyword}{>}(calloc(\mbox{\hyperlink{classBufStr_a05a5b09aa190249aaa59b5ddcf0bddc6}{size}},1));}
\DoxyCodeLine{36     \}}
\DoxyCodeLine{37     \mbox{\hyperlink{classBufStr_aceb0e03981b7c20ee59616b2ecde261a}{\string~BufStr}}()}
\DoxyCodeLine{38     \{}
\DoxyCodeLine{39       free(m\_buf);}
\DoxyCodeLine{40     \}}
\DoxyCodeLine{41     \textcolor{keywordtype}{void} \mbox{\hyperlink{classBufStr_a36ec062edea86b33b794eeab37f32b1c}{addChar}}(\textcolor{keywordtype}{char} c)}
\DoxyCodeLine{42     \{}
\DoxyCodeLine{43       makeRoomFor(1);}
\DoxyCodeLine{44       m\_buf[m\_writeOffset++]=c;}
\DoxyCodeLine{45     \}}
\DoxyCodeLine{46     \textcolor{keywordtype}{void} \mbox{\hyperlink{classBufStr_a1b51ff3c6cd8c69cd32992570ef109d4}{addArray}}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *a,\textcolor{keywordtype}{size\_t} len)}
\DoxyCodeLine{47     \{}
\DoxyCodeLine{48       makeRoomFor(len);}
\DoxyCodeLine{49       memcpy(m\_buf+m\_writeOffset,a,len);}
\DoxyCodeLine{50       m\_writeOffset+=len;}
\DoxyCodeLine{51     \}}
\DoxyCodeLine{52     \textcolor{keywordtype}{void} \mbox{\hyperlink{classBufStr_af3a94f59f1f7326281202943ed631518}{skip}}(\textcolor{keywordtype}{size\_t} \mbox{\hyperlink{namespacecaseconvert_a2d40a560e370c1b43ad3f58ac4dfa416}{s}})}
\DoxyCodeLine{53     \{}
\DoxyCodeLine{54       makeRoomFor(\mbox{\hyperlink{namespacecaseconvert_a2d40a560e370c1b43ad3f58ac4dfa416}{s}});}
\DoxyCodeLine{55       m\_writeOffset+=\mbox{\hyperlink{namespacecaseconvert_a2d40a560e370c1b43ad3f58ac4dfa416}{s}};}
\DoxyCodeLine{56     \}}
\DoxyCodeLine{57     \textcolor{keywordtype}{void} \mbox{\hyperlink{classBufStr_a1249e1bd467994877b9671a525782e12}{shrink}}( \textcolor{keywordtype}{size\_t} newlen )}
\DoxyCodeLine{58     \{}
\DoxyCodeLine{59       m\_writeOffset=newlen;}
\DoxyCodeLine{60       \mbox{\hyperlink{classBufStr_af4bda58a1b9cbf4f33fe3d247502e1f4}{resize}}(newlen);}
\DoxyCodeLine{61     \}}
\DoxyCodeLine{62     \textcolor{keywordtype}{void} \mbox{\hyperlink{classBufStr_af4bda58a1b9cbf4f33fe3d247502e1f4}{resize}}( \textcolor{keywordtype}{size\_t} newlen )}
\DoxyCodeLine{63     \{}
\DoxyCodeLine{64       \textcolor{keywordtype}{size\_t} oldsize = m\_size;}
\DoxyCodeLine{65       m\_size=newlen;}
\DoxyCodeLine{66       \textcolor{keywordflow}{if} (m\_writeOffset>=m\_size) \textcolor{comment}{// offset out of range -\/> enlarge}}
\DoxyCodeLine{67       \{}
\DoxyCodeLine{68         m\_size=m\_writeOffset+m\_spareRoom;}
\DoxyCodeLine{69       \}}
\DoxyCodeLine{70       m\_buf = \textcolor{keyword}{static\_cast<}\textcolor{keywordtype}{char} *\textcolor{keyword}{>}(realloc(m\_buf,m\_size));}
\DoxyCodeLine{71       \textcolor{keywordflow}{if} (m\_size>oldsize)}
\DoxyCodeLine{72       \{}
\DoxyCodeLine{73         memset(m\_buf+oldsize,0,m\_size-\/oldsize);}
\DoxyCodeLine{74       \}}
\DoxyCodeLine{75     \}}
\DoxyCodeLine{76     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classBufStr_a05a5b09aa190249aaa59b5ddcf0bddc6}{size}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{77 \textcolor{keyword}{    }\{}
\DoxyCodeLine{78       \textcolor{keywordflow}{return} m\_size;}
\DoxyCodeLine{79     \}}
\DoxyCodeLine{80     \textcolor{keywordtype}{char} *\mbox{\hyperlink{classBufStr_a38f1315046acdef23cab4dc53c6eda2b}{data}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{81 \textcolor{keyword}{    }\{}
\DoxyCodeLine{82       \textcolor{keywordflow}{return} m\_buf;}
\DoxyCodeLine{83     \}}
\DoxyCodeLine{84     \textcolor{keywordtype}{char} \&\mbox{\hyperlink{classBufStr_a9e4d9a1bd1d8f92d3994aff224ebaaf8}{at}}(\textcolor{keywordtype}{size\_t} i)\textcolor{keyword}{ const}}
\DoxyCodeLine{85 \textcolor{keyword}{    }\{}
\DoxyCodeLine{86       \textcolor{keywordflow}{return} m\_buf[i];}
\DoxyCodeLine{87     \}}
\DoxyCodeLine{88     \textcolor{keywordtype}{bool} \mbox{\hyperlink{classBufStr_a5dae2d2677e172a6bbe67c3dead0437d}{isEmpty}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{89 \textcolor{keyword}{    }\{}
\DoxyCodeLine{90       \textcolor{keywordflow}{return} m\_writeOffset==0;}
\DoxyCodeLine{91     \}}
\DoxyCodeLine{92     \textcolor{keyword}{operator} \textcolor{keyword}{const} \textcolor{keywordtype}{char} *() \textcolor{keyword}{const}}
\DoxyCodeLine{93     \{}
\DoxyCodeLine{94       \textcolor{keywordflow}{return} m\_buf;}
\DoxyCodeLine{95     \}}
\DoxyCodeLine{96     \textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classBufStr_a3d71cf69bfeaa8fa67bc3b85c41c3723}{curPos}}()\textcolor{keyword}{ const}}
\DoxyCodeLine{97 \textcolor{keyword}{    }\{}
\DoxyCodeLine{98       \textcolor{keywordflow}{return} m\_writeOffset;}
\DoxyCodeLine{99     \}}
\DoxyCodeLine{100     \textcolor{keywordtype}{void} \mbox{\hyperlink{classBufStr_a301e1d54d3d97f819e2c08d0350f3b7f}{dropFromStart}}(\textcolor{keywordtype}{size\_t} bytes)}
\DoxyCodeLine{101     \{}
\DoxyCodeLine{102       \textcolor{keywordflow}{if} (bytes>m\_size) bytes=m\_size;}
\DoxyCodeLine{103       \textcolor{keywordflow}{if} (bytes>0) \mbox{\hyperlink{qcstring_8cpp_ad44bc2f81d70fe50067f691cbae5075b}{qmemmove}}(m\_buf,m\_buf+bytes,m\_size-\/bytes);}
\DoxyCodeLine{104       m\_size-\/=bytes;}
\DoxyCodeLine{105       m\_writeOffset-\/=bytes;}
\DoxyCodeLine{106     \}}
\DoxyCodeLine{107   \textcolor{keyword}{private}:}
\DoxyCodeLine{108     \textcolor{keywordtype}{void} makeRoomFor(\textcolor{keywordtype}{size\_t} \mbox{\hyperlink{classBufStr_a05a5b09aa190249aaa59b5ddcf0bddc6}{size}})}
\DoxyCodeLine{109     \{}
\DoxyCodeLine{110       \textcolor{keywordflow}{if} (m\_writeOffset+\mbox{\hyperlink{classBufStr_a05a5b09aa190249aaa59b5ddcf0bddc6}{size}}>=m\_size)}
\DoxyCodeLine{111       \{}
\DoxyCodeLine{112         \mbox{\hyperlink{classBufStr_af4bda58a1b9cbf4f33fe3d247502e1f4}{resize}}(m\_size+\mbox{\hyperlink{classBufStr_a05a5b09aa190249aaa59b5ddcf0bddc6}{size}}+m\_spareRoom);}
\DoxyCodeLine{113       \}}
\DoxyCodeLine{114     \}}
\DoxyCodeLine{115     \textcolor{keywordtype}{size\_t} m\_size;}
\DoxyCodeLine{116     \textcolor{keywordtype}{size\_t} m\_writeOffset;}
\DoxyCodeLine{117     \textcolor{keyword}{const} \textcolor{keywordtype}{size\_t} m\_spareRoom; \textcolor{comment}{// 10Kb extra room to avoid frequent resizing}}
\DoxyCodeLine{118     \textcolor{keywordtype}{char} *m\_buf;}
\DoxyCodeLine{119 \};}
\DoxyCodeLine{120 }
\DoxyCodeLine{121 }
\DoxyCodeLine{122 \textcolor{preprocessor}{\#endif}}

\end{DoxyCode}
